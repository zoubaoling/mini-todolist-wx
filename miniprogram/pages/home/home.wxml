<view class="home-page">
  <!-- header -->
  <navigator-bar title="æ™ºèƒ½å¾…åŠæ¸…å•" subTitle="è®©ç”Ÿæ´»æ›´æœ‰åº"></navigator-bar>
  <view class="home-content">
    <!-- ä»»åŠ¡æ¦‚è§ˆ -->
    <view class="task-overview">
      <view wx:for="{{overviewData}}" wx:key="label"
        class="overview-item">
        <text class="overview-item-value">{{item.value}}</text>
        <text class="overview-item-label">{{item.label}}</text>
      </view>
    </view>
    <!-- ä»»åŠ¡åˆ—è¡¨ -->
    <view class="task-content">
      <!-- è¿‡æ»¤å™¨ -->
      <view class="filter-content">
        <!-- æœç´¢æ¡† -->
        <view class="search-input-container">
          <input
            class="search-input"
            placeholder="æœç´¢ä»»åŠ¡..."
            placeholder-class="search-input__placeholder"
            model:value="{{searchTaskValue}}"
            bind:confirm="handleSearchTask"
            bind:input="debounceSearchTask"
            confirm-type="search"
          />
          <!-- æ¸…é™¤æŒ‰é’® -->
          <view 
            wx:if="{{searchTaskValue}}"
            class="search-clear-btn"
            bind:tap="clearSearch"
          >
            <text class="search-clear-icon">Ã—</text>
          </view>
        </view>
        
        <view class="search-tabs">
          <view
            wx:for="{{searchTaskTabs}}"
            wx:key="type"
            bind:tap="handleSearchTabTap"
            data-type="{{item.type}}"
            class="search-tab {{selectedSearchTaskTab === item.type ? 'search-tab-active' : ''}}"
            >
            <text>{{item.label}}</text>
          </view>
        </view>
      </view>
      <!-- è¿‡æ»¤ä»»åŠ¡åˆ—è¡¨ -->
      <scroll-view 
        class="task-list"
        scroll-y
        enhanced
        show-scrollbar="{{true}}"
        refresher-enabled="{{true}}"
        bindscroll="handleScroll"
        >
        <!-- ä»»åŠ¡åˆ—è¡¨ -->
        <block wx:for="{{taskList}}" wx:key="_id" wx:if="{{taskList.length > 0}}">
          <t-swipe-cell
            id="{{item._id}}"
            >
            <view
              class="task-item {{item.itemClass}}"
              bind:tap="navigateToTaskDetail"
              data-id="{{item._id}}"
              data-status="{{item.status}}"
              data-is-editable="{{item.isEditable}}"
              >
              <view class="task-header">
                <!-- todo: ä»»åŠ¡å®Œæˆåï¼Œåˆ’çº¿ç°è´¨ç¦æ­¢æ“ä½œ -->
                <view class="radio-group">
                  <label class="radio-item">
                    <radio 
                      class="radio-item-radio" 
                      color="#667eea"
                      value="{{item.id}}"
                      checked="{{item.status === 'COMPLETED'}}"
                      catch:tap="handleTaskStatusChange"
                      data-id="{{item._id}}"
                      data-status="{{item.status}}"
                      data-is-editable="{{item.isEditable}}"
                    />
                    <text class="radio-item-text {{item.textClass}}">{{item.text}}</text>
                  </label>
                </view>
                <view class="task-priority {{item.priorityClass}} {{item.textClass}}">{{item.priorityLabel}}</view>
              </view>
              <view class="task-meta">
                <!-- å·²å®Œæˆã€æœªå®Œæˆçš„æ—¶é—´ -->
                <view class="task-date">
                  <image src="/assets/images/date.png" class="task-date-icon" />
                  <text class="task-date-text {{item.dateClass}}">{{ item.status === 'COMPLETED' ? 'å·²å®Œæˆ' : item.date}}</text>
                </view>
                <view class="task-category {{item.categoryClass}}">{{item.categoryLabel}}</view>
              </view>
            </view>
            <view slot="right" class="right-slot">
              <view wx:if="{{item.isEditable}}" class="btn edit-btn column" data-id="{{item._id}}" bind:tap="onSwipeCellEditClick">
                ç¼–è¾‘
              </view>
              <view class="btn delete-btn column" data-id="{{item._id}}" bind:tap="onSwipeCellDeleteClick">
                åˆ é™¤
              </view>
            </view>
          </t-swipe-cell>
        </block>
        <!-- ç©ºçŠ¶æ€ -->
        <view wx:if="{{taskList.length === 0}}" class="empty-state">
          <view class="empty-state-icon">
            <text class="empty-icon">ğŸ“</text>
          </view>
          <view class="empty-state-title">æš‚æ— ä»»åŠ¡</view>
          <view class="empty-state-desc">
            <text wx:if="{{selectedSearchTaskTab === 'ALL'}}">è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•ä»»åŠ¡ï¼Œå¿«å»æ·»åŠ ç¬¬ä¸€ä¸ªä»»åŠ¡å§ï¼</text>
            <text wx:else>å½“å‰åˆ†ç±»ä¸‹æš‚æ— ä»»åŠ¡ï¼Œè¯•è¯•å…¶ä»–åˆ†ç±»æˆ–åˆ›å»ºæ–°ä»»åŠ¡</text>
          </view>
          <button class="empty-state-btn" bind:tap="navigateToAddTask">
            <text>+ æ·»åŠ ä»»åŠ¡</text>
          </button>
        </view>
      </scroll-view>
    </view>
  </view>
  
  <!-- æ‚¬æµ®æŒ‰é’®ï¼šåªåœ¨æœ‰ä»»åŠ¡æ—¶æ˜¾ç¤º -->
  <button 
    wx:if="{{taskList.length > 0}}" 
    class="floating-add-btn" 
    bindtap="navigateToAddTask"
  >
    <text>+</text>
  </button>
</view>